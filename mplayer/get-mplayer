#!/bin/bash
download_url='ftp://ftp.mplayerhq.hu/MPlayer/releases/MPlayer-1.1.1.tar.xz'
src_directory=`basename $download_url .tar.xz`

download=true
if [ -d "$src_directory" ]; then
  read -p "Source code directory already exists. Download again?" yn
  if [ "$yn" != "y" ]; then
    download=false
  fi
fi

if [ "$download" = true ]; then
  echo "Downloading source code."
  curl -sS $download_url | tar -xvf -
  if [ ! -d "$src_directory" ]; then
    echo "Download failed."
    exit 1
  fi
fi

echo "Patching vo_corevideo.h and vo_corevideo.m."
cp -f vo_corevideo.h vo_corevideo.m $src_directory/libvo/

